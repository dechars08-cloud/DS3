<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS to make the table scroll on small screens and to make the page look amazing on all devices */
        @media (max-width: 640px) {
            .table-container {
                overflow-x: auto;
            }
        }
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8 font-sans">
    <div class="container mx-auto max-w-4xl bg-white p-6 rounded-lg shadow-2xl">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î üë©‚Äçüè´</h1>

        <!-- Summary Section -->
        <div class="mb-6 grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="bg-blue-100 p-4 rounded-lg text-center shadow-md">
                <p class="text-xl font-semibold text-blue-800">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <p id="totalStudents" class="text-4xl font-bold text-blue-900 mt-2">0</p>
            </div>
            <div class="bg-yellow-100 p-4 rounded-lg text-center shadow-md">
                <p class="text-xl font-semibold text-yellow-800">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</p>
                <p id="averageScore" class="text-4xl font-bold text-yellow-900 mt-2">0.00</p>
            </div>
        </div>

        <!-- Chart Section -->
        <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 shadow-sm">
            <h2 class="text-xl font-semibold mb-2 text-gray-700 text-center">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡πÄ‡∏Å‡∏£‡∏î</h2>
            <div class="flex justify-center">
                <canvas id="gradeChart" class="max-w-full h-auto"></canvas>
            </div>
        </div>

        <!-- Score Weighting Configuration Section -->
        <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 shadow-sm">
            <h2 class="text-xl font-semibold mb-2 text-gray-700">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
            <div class="flex flex-col sm:flex-row gap-4">
                <div class="flex-1">
                    <label for="workWeight" class="block text-gray-600 font-medium">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö (0-1):</label>
                    <input type="number" id="workWeight" value="0.6" step="0.1" min="0" max="1"
                           class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                </div>
                <div class="flex-1">
                    <label for="examWeight" class="block text-gray-600 font-medium">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö (0-1):</label>
                    <input type="number" id="examWeight" value="0.4" step="0.1" min="0" max="1"
                           class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                </div>
            </div>
        </div>

        <!-- Student Form Section -->
        <div class="mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200 shadow-sm">
            <h2 class="text-xl font-semibold mb-2 text-gray-700">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="studentForm" class="space-y-4">
                <div>
                    <label for="studentName" class="block text-gray-600 font-medium">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
                    <input type="text" id="studentName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" required
                           class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                </div>
                <div class="flex flex-col sm:flex-row gap-4">
                    <div class="flex-1">
                        <label for="workScore" class="block text-gray-600 font-medium">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö:</label>
                        <input type="number" id="workScore" placeholder="0-100" min="0" max="100" required
                               class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                    <div class="flex-1">
                        <label for="examScore" class="block text-gray-600 font-medium">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö:</label>
                        <input type="number" id="examScore" placeholder="0-100" min="0" max="100" required
                               class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
                    </div>
                </div>
                <button type="submit"
                        class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md">
                    ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
                </button>
            </form>
        </div>

        <!-- Results Table Section -->
        <div class="table-container mb-6">
            <table class="min-w-full bg-white border border-gray-200 rounded-lg shadow-sm">
                <thead>
                    <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                        <th class="py-3 px-6 text-left">#</th>
                        <th class="py-3 px-6 text-left">‡∏ä‡∏∑‡πà‡∏≠</th>
                        <th class="py-3 px-6 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö</th>
                        <th class="py-3 px-6 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö</th>
                        <th class="py-3 px-6 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</th>
                        <th class="py-3 px-6 text-center">‡πÄ‡∏Å‡∏£‡∏î</th>
                        <th class="py-3 px-6 text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody id="gradeTableBody" class="text-gray-600 text-sm font-light">
                    <!-- Student data will be populated here by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Action Button Section -->
        <div class="flex flex-col sm:flex-row gap-4 mt-4">
            <button id="calculateAllBtn"
                    class="flex-1 bg-green-600 text-white font-bold py-3 px-4 rounded-md hover:bg-green-700 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 shadow-md">
                ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
            <button id="importCsvBtn"
                    class="flex-1 bg-purple-600 text-white font-bold py-3 px-4 rounded-md hover:bg-purple-700 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 shadow-md">
                ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å CSV
            </button>
            <input type="file" id="csvFileInput" class="hidden" accept=".csv">
            <button id="exportCsvBtn"
                    class="flex-1 bg-gray-600 text-white font-bold py-3 px-4 rounded-md hover:bg-gray-700 transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 shadow-md">
                ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô CSV
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // JavaScript Code
        document.addEventListener('DOMContentLoaded', () => {
            // Get all necessary elements from the DOM
            const studentForm = document.getElementById('studentForm');
            const gradeTableBody = document.getElementById('gradeTableBody');
            const calculateAllBtn = document.getElementById('calculateAllBtn');
            const workWeightInput = document.getElementById('workWeight');
            const examWeightInput = document.getElementById('examWeight');
            const exportCsvBtn = document.getElementById('exportCsvBtn');
            const importCsvBtn = document.getElementById('importCsvBtn');
            const csvFileInput = document.getElementById('csvFileInput');
            const totalStudentsElem = document.getElementById('totalStudents');
            const averageScoreElem = document.getElementById('averageScore');
            const gradeChartCtx = document.getElementById('gradeChart').getContext('2d');
            let gradeChart;

            // Initial student data for demonstration
            const initialStudents = [
                { name: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', workScore: 82, examScore: 88 },
                { name: '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à', workScore: 76, examScore: 91 },
                { name: '‡∏°‡∏≤‡∏ô‡∏∞ ‡∏≠‡∏î‡∏ó‡∏ô', workScore: 95, examScore: 85 },
                { name: '‡∏õ‡∏¥‡∏ï‡∏¥ ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå', workScore: 68, examScore: 72 },
                { name: '‡∏î‡∏ß‡∏á‡πÉ‡∏à ‡∏á‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°', workScore: 54, examScore: 63 }
            ];

            // Load student data from localStorage or use the initial data
            let students = JSON.parse(localStorage.getItem('grades')) || initialStudents;

            // Custom alert/modal function to replace window.alert
            function showAlert(message) {
                // Create modal container
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50';
                
                // Create modal content box
                const modalContent = document.createElement('div');
                modalContent.className = 'bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center transform scale-95 transition-transform duration-300';
                modalContent.innerHTML = `
                    <p class="text-lg font-semibold text-gray-800 mb-4">${message}</p>
                    <button class="bg-blue-600 text-white font-bold py-2 px-6 rounded-md hover:bg-blue-700 transition-colors">‡∏ï‡∏Å‡∏•‡∏á</button>
                `;
                
                modal.appendChild(modalContent);
                document.body.appendChild(modal);

                // Add event listener to close modal
                const closeBtn = modalContent.querySelector('button');
                closeBtn.addEventListener('click', () => {
                    modal.remove();
                });
            }

            // Function to calculate total score and grade
            function calculateGrade(workScore, examScore, workWeight, examWeight) {
                // Calculate the total weighted score
                const totalScore = (workScore * workWeight) + (examScore * examWeight);
                let grade = '';

                // Assign a grade based on the score
                if (totalScore >= 80) grade = 'A';
                else if (totalScore >= 70) grade = 'B';
                else if (totalScore >= 60) grade = 'C';
                else if (totalScore >= 50) grade = 'D';
                else grade = 'F';

                // Return an object with the total score and the assigned grade
                return { totalScore: totalScore.toFixed(2), grade };
            }

            // Function to update the summary cards and chart
            function updateSummary() {
                const workWeight = parseFloat(workWeightInput.value);
                const examWeight = parseFloat(examWeightInput.value);

                if (students.length === 0) {
                    totalStudentsElem.textContent = '0';
                    averageScoreElem.textContent = '0.00';
                    if (gradeChart) gradeChart.destroy();
                    return;
                }
                
                // Calculate total and average score
                const totalScoreSum = students.reduce((sum, student) => {
                    const { totalScore } = calculateGrade(student.workScore, student.examScore, workWeight, examWeight);
                    return sum + parseFloat(totalScore);
                }, 0);
                const averageScore = totalScoreSum / students.length;

                // Count students by grade
                const gradeCounts = { 'A': 0, 'B': 0, 'C': 0, 'D': 0, 'F': 0 };
                students.forEach(student => {
                    const { grade } = calculateGrade(student.workScore, student.examScore, workWeight, examWeight);
                    gradeCounts[grade]++;
                });

                // Update summary cards
                totalStudentsElem.textContent = students.length;
                averageScoreElem.textContent = averageScore.toFixed(2);

                // Update or create the chart
                if (gradeChart) {
                    gradeChart.data.datasets[0].data = Object.values(gradeCounts);
                    gradeChart.update();
                } else {
                    gradeChart = new Chart(gradeChartCtx, {
                        type: 'bar',
                        data: {
                            labels: Object.keys(gradeCounts),
                            datasets: [{
                                label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                                data: Object.values(gradeCounts),
                                backgroundColor: [
                                    'rgba(34, 197, 94, 0.6)', // Green for A
                                    'rgba(59, 130, 246, 0.6)', // Blue for B
                                    'rgba(245, 158, 11, 0.6)', // Yellow for C
                                    'rgba(249, 115, 22, 0.6)', // Orange for D
                                    'rgba(239, 68, 68, 0.6)' // Red for F
                                ],
                                borderColor: [
                                    'rgba(34, 197, 94, 1)',
                                    'rgba(59, 130, 246, 1)',
                                    'rgba(245, 158, 11, 1)',
                                    'rgba(249, 115, 22, 1)',
                                    'rgba(239, 68, 68, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        stepSize: 1
                                    }
                                }
                            }
                        }
                    });
                }
            }

            // Function to render the student table
            function renderTable() {
                gradeTableBody.innerHTML = ''; // Clear the existing table rows
                const workWeight = parseFloat(workWeightInput.value);
                const examWeight = parseFloat(examWeightInput.value);

                // Check if the weights add up to 1.0, and if not, show an alert and don't render.
                if (Math.abs(workWeight + examWeight - 1.0) > 0.001) {
                    showAlert('‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 1.0');
                    return;
                }

                // Loop through the students array to create and append table rows
                students.forEach((student, index) => {
                    const { totalScore, grade } = calculateGrade(student.workScore, student.examScore, workWeight, examWeight);
                    const row = document.createElement('tr');
                    row.className = 'border-b border-gray-200 hover:bg-gray-100 transition-colors';
                    row.setAttribute('data-index', index);
                    row.innerHTML = `
                        <td class="py-3 px-6 text-left whitespace-nowrap">${index + 1}</td>
                        <td class="py-3 px-6 text-left">${student.name}</td>
                        <td class="py-3 px-6 text-center" contenteditable="true" data-field="workScore">${student.workScore}</td>
                        <td class="py-3 px-6 text-center" contenteditable="true" data-field="examScore">${student.examScore}</td>
                        <td class="py-3 px-6 text-center font-bold">${totalScore}</td>
                        <td class="py-3 px-6 text-center">
                            <span class="font-bold py-1 px-3 rounded-full text-xs ${
                                grade === 'A' ? 'bg-green-200 text-green-800' :
                                grade === 'B' ? 'bg-blue-200 text-blue-800' :
                                grade === 'C' ? 'bg-yellow-200 text-yellow-800' :
                                grade === 'D' ? 'bg-orange-200 text-orange-800' :
                                'bg-red-200 text-red-800'
                            }">${grade}</span>
                        </td>
                        <td class="py-3 px-6 text-center">
                            <button class="delete-btn text-red-500 hover:text-red-700 transition-colors font-bold">
                                ‡∏•‡∏ö
                            </button>
                        </td>
                    `;
                    gradeTableBody.appendChild(row);
                });

                // Save student data to localStorage after rendering
                localStorage.setItem('grades', JSON.stringify(students));
                updateSummary();
            }

            // Event listener for the table body to handle edits and deletions
            gradeTableBody.addEventListener('blur', (e) => {
                const target = e.target;
                if (target.matches('[contenteditable="true"]')) {
                    const index = target.closest('tr').dataset.index;
                    const field = target.dataset.field;
                    const newValue = parseFloat(target.textContent);

                    if (isNaN(newValue) || newValue < 0 || newValue > 100) {
                        showAlert('‡πÇ‡∏õ‡∏£‡∏î‡∏õ‡πâ‡∏≠‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0-100 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
                        target.textContent = students[index][field]; // Revert to old value
                    } else {
                        students[index][field] = newValue;
                        renderTable();
                    }
                }
            }, true); // Use capture phase to ensure event is handled before it bubbles up

            gradeTableBody.addEventListener('click', (e) => {
                const target = e.target;
                if (target.classList.contains('delete-btn')) {
                    const index = target.closest('tr').dataset.index;
                    students.splice(index, 1);
                    renderTable();
                    showAlert('‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
                }
            });

            // Event listener for the student form submission
            studentForm.addEventListener('submit', (e) => {
                e.preventDefault(); // Prevent the default form submission (page reload)
                const name = document.getElementById('studentName').value;
                const workScore = parseFloat(document.getElementById('workScore').value);
                const examScore = parseFloat(document.getElementById('examScore').value);

                // Add the new student to the array
                students.push({ name, workScore, examScore });
                renderTable(); // Re-render the table
                studentForm.reset(); // Clear the form fields
                showAlert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
            });

            // Event listener for the "Calculate All" button
            calculateAllBtn.addEventListener('click', () => {
                renderTable(); // Recalculate and re-render the table
                showAlert('‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            });

            // Event listener for the "Export CSV" button
            exportCsvBtn.addEventListener('click', () => {
                const workWeight = parseFloat(workWeightInput.value);
                const examWeight = parseFloat(examWeightInput.value);
                
                // Header row for CSV file
                let csvContent = "‡∏•‡∏≥‡∏î‡∏±‡∏ö,‡∏ä‡∏∑‡πà‡∏≠,‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏Å‡πá‡∏ö,‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö,‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°,‡πÄ‡∏Å‡∏£‡∏î\n";
                
                // Loop through student data and create a row for each
                students.forEach((student, index) => {
                    const { totalScore, grade } = calculateGrade(student.workScore, student.examScore, workWeight, examWeight);
                    const row = `${index + 1},"${student.name}",${student.workScore},${student.examScore},${totalScore},${grade}\n`;
                    csvContent += row;
                });

                // Create a Blob from the CSV string
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement("a");
                
                // Create a filename and trigger download
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                link.setAttribute("download", "student_grades.csv");
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showAlert('‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå CSV ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
            });

            // Event listener for the "Import CSV" button
            importCsvBtn.addEventListener('click', () => {
                // Trigger the hidden file input
                csvFileInput.click();
            });

            // Event listener for the file input change
            csvFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const csvText = event.target.result;
                        const rows = csvText.trim().split('\n');
                        const newStudents = [];

                        // Skip header row if it exists
                        const startRow = rows[0].includes('‡∏ä‡∏∑‡πà‡∏≠') || rows[0].includes('name') ? 1 : 0;
                        
                        for (let i = startRow; i < rows.length; i++) {
                            const columns = rows[i].split(',');
                            // Assumes columns are [index, name, workScore, examScore, ...]
                            if (columns.length >= 4) {
                                const name = columns[1].trim().replace(/"/g, '');
                                const workScore = parseFloat(columns[2].trim());
                                const examScore = parseFloat(columns[3].trim());

                                if (!isNaN(workScore) && !isNaN(examScore)) {
                                    newStudents.push({ name, workScore, examScore });
                                }
                            }
                        }
                        
                        students = newStudents;
                        renderTable();
                        showAlert('‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
                    } catch (error) {
                        showAlert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV');
                        console.error('CSV Parsing error:', error);
                    }
                };
                reader.readAsText(file, 'UTF-8');
            });

            // Event listeners for changes in score weights
            workWeightInput.addEventListener('change', renderTable);
            examWeightInput.addEventListener('change', renderTable);

            // Initial render of the table and summary when the page loads
            renderTable();
        });
    </script>
</body>
</html>
